<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>ğŸ’° EURO_GOALS â€“ Smart Money Odds Monitor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/static/icon_green.png">
  <style>
    body { background:#0d1117;color:#fff;font-family:'Segoe UI',Arial,sans-serif;margin:0;padding:0; }
    h1 { text-align:center;color:#00ffae;margin:15px 0; }
    table { width:95%;margin:auto;border-collapse:collapse; }
    th,td { text-align:center;padding:8px;border-bottom:1px solid #222; }
    th { background:#111927;color:#00b0ff; }
    tr.alert { background:rgba(255,0,0,0.08); }
    tr:hover { background:rgba(255,255,255,0.05); }
    .movement-up { color:#00ff88;font-weight:bold; }
    .movement-down { color:#ff4444;font-weight:bold; }
    #timestamp { text-align:center;color:#888;margin-top:15px; }
    .status-bar { text-align:center;color:#777;margin:20px 0;font-size:13px; }
  </style>
</head>
<body>

  <h1>ğŸ’° Smart Money Odds Tracker</h1>

  <table id="smartTable">
    <thead>
      <tr>
        <th>Î‘Î³ÏÎ½Î±Ï‚</th>
        <th>Î‘Î³Î¿ÏÎ¬</th>
        <th>Start Odds</th>
        <th>Current Odds</th>
        <th>ÎœÎµÏ„Î±Î²Î¿Î»Î®</th>
        <th>ÎÏÎ± Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·Ï‚</th>
      </tr>
    </thead>
    <tbody id="smartBody">
      <tr><td colspan="6">Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½...</td></tr>
    </tbody>
  </table>

  <div id="timestamp">Î‘Î½Î±Î¼Î¿Î½Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½...</div>
  <div class="status-bar">Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÎºÎ¬Î¸Îµ 60 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±</div>

  <audio id="alertSound" src="/static/sounds/smartmoney_alert.mp3" preload="auto"></audio>

  <script>
    const audio=document.getElementById("alertSound");
    let lastMovements={};

    async function updateSmartMoney(){
      try{
        const res=await fetch("/smartmoney_feed");
        const data=await res.json();
        const tbody=document.getElementById("smartBody");
        tbody.innerHTML="";

        data.forEach(item=>{
          let trendClass="";
          if(item.movement.includes("â†‘")) trendClass="movement-up";
          if(item.movement.includes("â†“")) trendClass="movement-down";

          // Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î½Î­Î± Î±Î»Î»Î±Î³Î® & ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ® Î´Î¹Î±Ï†Î¿ÏÎ¬ â†’ Î®Ï‡Î¿Ï‚
          if(lastMovements[item.match]!==item.movement){
            const start=item.start_odds["1"];
            const current=item.current_odds["1"];
            if(Math.abs(start-current)>0.15){
              audio.currentTime=0;
              audio.play().catch(()=>{});
            }
          }
          lastMovements[item.match]=item.movement;

          const row=document.createElement("tr");
          row.innerHTML=`
            <td>${item.match}</td>
            <td>${item.market}</td>
            <td>${item.start_odds["1"].toFixed(2)} â€“ ${item.start_odds["X"].toFixed(2)} â€“ ${item.start_odds["2"].toFixed(2)}</td>
            <td>${item.current_odds["1"].toFixed(2)} â€“ ${item.current_odds["X"].toFixed(2)} â€“ ${item.current_odds["2"].toFixed(2)}</td>
            <td class="${trendClass}">${item.movement}</td>
            <td>${item.timestamp}</td>
          `;
          tbody.appendChild(row);
        });

        document.getElementById("timestamp").innerText=
          "Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·: "+new Date().toLocaleTimeString("el-GR");

      }catch(err){
        console.error("Î£Ï†Î¬Î»Î¼Î± SmartMoney feed:",err);
      }
    }

    updateSmartMoney();
    setInterval(updateSmartMoney,60000);
  </script>

  <div class="footer" style="text-align:center;color:#777;margin:25px 0;">
    EURO_GOALS SmartMoney v8.9h Â© 2025
  </div>
</body>
</html>
