<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>AI MatchLab PREMIUM</title>

    <!-- PWA -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#0b0f1a" />

    <!-- iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="AI MatchLab" />

    <!-- Correct Icons -->
    <link rel="apple-touch-icon" sizes="192x192" href="/static/icons/icon-192.png" />
    <link rel="apple-touch-icon" sizes="512x512" href="/static/icons/icon-512.png" />
    <link rel="icon" sizes="192x192" href="/static/icons/icon-192.png" />
    <link rel="icon" sizes="512x512" href="/static/icons/icon-512.png" />

    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/aimatchlab.css" />
</head>

<body class="aiml-body">

    <!-- HEADER -->
    <header class="aiml-header">
        <div class="aiml-header-left">
            <div class="aiml-logo-circle">AI</div>
            <div class="aiml-title-block">
                <div class="aiml-title">AI MATCHLAB</div>
                <div class="aiml-subtitle">Advanced Live Intelligence Engine</div>
            </div>

            <div class="aiml-header-badges">
                <span class="aiml-badge env">ENV: DEVELOPMENT</span>
                <span class="aiml-badge version">v0.9.3 PREMIUM</span>
            </div>
        </div>

        <div class="aiml-header-right">
            <button id="themeToggleBtn" class="aiml-header-btn aiml-theme-btn">ðŸŽ¨ Theme</button>
            <button id="installBtn" class="aiml-header-btn aiml-install-btn">â¬‡ Install</button>
            <button id="refreshBtn" class="aiml-header-btn aiml-refresh-btn">âŸ³ Refresh</button>
        </div>
    </header>

    <!-- SUMMARY BAR -->
    <section class="aiml-summary-bar">
        <div class="aiml-summary-card">
            <div class="aiml-summary-label">BACKEND</div>
            <div id="backendStatusValue" class="aiml-summary-value aiml-summary-ok">Online</div>
            <div class="aiml-summary-caption">FastAPI Health</div>
        </div>

        <div class="aiml-summary-card">
            <div class="aiml-summary-label">WORKER</div>
            <div id="workerStatusValue" class="aiml-summary-value aiml-summary-issue">Checkingâ€¦</div>
            <div id="workerSummaryCaption" class="aiml-summary-caption">No data</div>
        </div>

        <div class="aiml-summary-card">
            <div class="aiml-summary-label">LIVE FEED</div>
            <div id="feedStatusValue" class="aiml-summary-value aiml-summary-issue">No data</div>
            <div id="feedSummaryCaption" class="aiml-summary-caption">Awaiting feed</div>
        </div>
    </section>

    <!-- MAIN GRID -->
    <main class="aiml-main-grid">

        <!-- LIVE PANEL -->
        <section class="aiml-panel aiml-live-panel">
            <div class="aiml-panel-header">
                <div>
                    <div class="aiml-panel-title">AI MatchLab â€“ Live Matrix</div>
                    <div class="aiml-panel-subtitle">Unified Live / Recent / Upcoming feed</div>
                </div>

                <div class="aiml-tabs">
                    <button id="btnAll" class="aiml-tab aiml-tab-active">All</button>
                    <button id="btnLive" class="aiml-tab">Live</button>
                    <button id="btnRecent" class="aiml-tab">Recent</button>
                    <button id="btnUpcoming" class="aiml-tab">Upcoming</button>
                </div>
            </div>

            <div id="liveContainer" class="aiml-live-container">
                <div id="liveSkeleton" class="aiml-skeleton-list">
                    <div class="aiml-skeleton-card"></div>
                    <div class="aiml-skeleton-card"></div>
                    <div class="aiml-skeleton-card"></div>
                </div>
                <div id="livePlaceholder" class="aiml-placeholder" style="display:none;">Waiting for live dataâ€¦</div>
            </div>
        </section>

        <!-- MONITOR PANEL -->
        <aside class="aiml-panel aiml-monitor-panel">
            <div class="aiml-panel-header">
                <div>
                    <div class="aiml-panel-title">AI System Monitor</div>
                    <div class="aiml-panel-subtitle">Worker Diagnostics</div>
                </div>
            </div>

            <div class="aiml-monitor-block">
                <div class="aiml-monitor-title">Worker Status (/ai/status)</div>
                <pre id="statusBox" class="aiml-monitor-pre">Loadingâ€¦</pre>
            </div>

            <div class="aiml-monitor-block">
                <div class="aiml-monitor-title">Live Payload (/ai/source-a/live)</div>
                <pre id="liveDebugBox" class="aiml-monitor-pre">Waitingâ€¦</pre>
            </div>
        </aside>

    </main>

    <!-- DEBUG PANEL -->
    <section class="aiml-debug-section">
        <div class="aiml-debug-header">
            <span class="aiml-debug-title">Debug Panel</span>
            <button id="toggleDebugBtn" class="aiml-debug-toggle-btn">Collapse</button>
        </div>
        <pre id="debugPanel" class="aiml-debug-pre">Waiting for debug dataâ€¦</pre>
    </section>

    <!-- FOOTER -->
    <footer class="aiml-footer">
        <a href="/legal/terms">Terms</a>
        <a href="/legal/privacy">Privacy</a>
        <a href="/legal/cookies">Cookies</a>
        <a href="/legal/responsible-gambling">Responsible Gambling</a>
    </footer>

    <!-- ENGINE -->
    <script src="/static/js/aimatchlab.js"></script>

    <!-- INSTALL HANDLER -->
    <script>
        let deferredPrompt = null;
        window.addEventListener("beforeinstallprompt", e => {
            e.preventDefault();
            deferredPrompt = e;
        });

        document.getElementById("installBtn").addEventListener("click", async () => {
            if (!deferredPrompt) {
                alert("To install:\n\nâ€¢ iOS: Share â†’ Add to Home Screen\nâ€¢ Android: Menu â†’ Install App");
                return;
            }
            deferredPrompt.prompt();
            deferredPrompt = null;
        });

        if ("serviceWorker" in navigator) {
            window.addEventListener("load", () => {
                navigator.serviceWorker.register("/service-worker.js", { scope: "/" });
            });
        }
    </script>

</body>

</html>
