<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ“œ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÎ¬ Î”ÎµÎ´Î¿Î¼Î­Î½Î± â€” EURO_GOALS v9.5.5 PRO+ Unified Expansion</title>
  <meta name="theme-color" content="#0a84ff" />
  <link rel="icon" href="/static/icons/eurogoals_512.png" sizes="512x512" />
  <link rel="stylesheet" href="/static/css/unified_theme.css" />
  <link rel="stylesheet" href="/static/css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: "Inter", system-ui, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg-dark, #0d1117);
      color: var(--text-dark, #e6e6e6);
      transition: background 0.4s ease, color 0.4s ease;
    }

    main {
      padding: 16px;
      max-width: 1100px;
      margin: 0 auto;
    }

    section.league-block {
      margin-bottom: 28px;
      background: rgba(20, 22, 25, 0.85);
      border-radius: 10px;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }

    .league-header {
      background: #161b22;
      color: #00bfff;
      font-weight: 600;
      padding: 10px 14px;
      border-bottom: 1px solid #1e1e1e;
      font-size: 1rem;
      position: sticky;
      top: 58px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.92rem;
    }

    th, td {
      padding: 9px 12px;
      border-bottom: 1px solid #2c2c2c;
    }

    tr:hover { background: rgba(255, 255, 255, 0.05); }

    td.date {
      color: #aaa;
      font-size: 0.85rem;
      width: 110px;
    }

    .loading {
      text-align: center;
      margin-top: 40px;
      color: #888;
    }

    footer {
      text-align: center;
      color: #777;
      padding: 20px;
      font-size: 0.8rem;
      border-top: 1px solid #222;
      margin-top: 40px;
    }

    @media (max-width: 768px) {
      table, tr, td, th {
        font-size: 0.85rem;
        padding: 8px;
      }
      .league-header { font-size: 0.95rem; padding: 8px 10px; }
      main { padding: 10px; }
    }
  </style>
</head>

<body data-theme="dark">
  {% include "partials/unified_header.html" %}

  <main id="content">
    <div id="loading" class="loading">Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏÎ½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½...</div>
  </main>

  <footer>Â© 2025 EURO_GOALS PRO+ | Unified Expansion â€” FlashScore / SofaScore History</footer>

  <script src="/static/js/theme_toggle.js"></script>
  <script>
    // ============================================================
    // HISTORY VIEW â€” EURO_GOALS v9.5.5 PRO+ Unified Expansion
    // ============================================================
    async function loadHistoryData() {
      const content = document.getElementById("content");
      const loading = document.getElementById("loading");

      try {
        const resp = await fetch("/api/history");
        const data = await resp.json();
        const items = data?.history || [];

        if (!items.length) {
          loading.textContent = "Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±.";
          return;
        }

        loading.style.display = "none";

        // ÎŸÎ¼Î±Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î±Î½Î¬ Î»Î¯Î³ÎºÎ±
        const grouped = {};
        for (const m of items) {
          const league = m.league?.trim() || "Î†Î³Î½Ï‰ÏƒÏ„Î· Î›Î¯Î³ÎºÎ±";
          if (!grouped[league]) grouped[league] = [];
          grouped[league].push(m);
        }

        const leagues = Object.keys(grouped).sort();

        content.innerHTML = leagues
          .map((league) => {
            const matches = grouped[league]
              .map(
                (m) => `
                  <tr>
                    <td class="date">${new Date(m.date * 1000 || Date.now()).toLocaleDateString("el-GR")}</td>
                    <td>${m.home_team || "-"} vs ${m.away_team || "-"}</td>
                    <td style="text-align:right;">${m.score || "-"}</td>
                  </tr>`
              )
              .join("");

            return `
              <section class="league-block">
                <div class="league-header">${league}</div>
                <table><tbody>${matches}</tbody></table>
              </section>`;
          })
          .join("");
      } catch (err) {
        loading.textContent = "âš  Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î· Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.";
        console.error("[EURO_GOALS] History fetch error:", err);
      }
    }

    window.addEventListener("load", loadHistoryData);
  </script>
</body>
</html>
