<div id="system-summary-bar" class="w-full bg-gray-800/80 backdrop-blur-md rounded-xl shadow p-2 mb-4 grid grid-cols-6 gap-2 text-center text-sm text-gray-200">
  <div class="summary-item" id="summary-db">ğŸ’¾ DB: Checking...</div>
  <div class="summary-item" id="summary-health">â¤ï¸ Health: Checking...</div>
  <div class="summary-item" id="summary-auto">ğŸ” Refresh: 60s</div>
  <div class="summary-item" id="summary-smartmoney">ğŸ’° SmartMoney: Checking...</div>
  <div class="summary-item" id="summary-render">ğŸŒ Render: Checking...</div>
  <div class="summary-item" id="summary-backup">â˜ï¸ Backup: Checking...</div>
</div>

<script>
async function updateSummaryBar() {
  try {
    const res = await fetch("/system_status_data");
    const data = await res.json();

    const map = {
      "DB": "summary-db",
      "Health": "summary-health",
      "Render": "summary-render",
      "SmartMoney": "summary-smartmoney",
      "Backup": "summary-backup"
    };

    for (const [key, value] of Object.entries(map)) {
      const el = document.getElementById(value);
      if (!el) continue;

      let icon = "";
      let color = "text-yellow-400";
      let shortText = data[key];

      // ---- icons ----
      if (key === "DB") icon = "ğŸ’¾";
      if (key === "Health") icon = "â¤ï¸";
      if (key === "Render") icon = "ğŸŒ";
      if (key === "SmartMoney") icon = "ğŸ’°";
      if (key === "Backup") icon = "â˜ï¸";

      // ---- coloring ----
      if (data[key].includes("OK") || data[key].includes("Connected") || data[key].includes("Active") || data[key].includes("Ready") || data[key].includes("Live")) {
        color = "text-green-400";
      } else if (data[key].includes("Fail") || data[key].includes("Error") || data[key].includes("Offline")) {
        color = "text-red-400";
      }

      // ---- compact health view ----
      if (key === "Health" && data[key].includes("OK")) shortText = "OK";

      // ---- render content ----
      el.innerHTML = `<span class="${color}" title="${data[key]}">${icon} ${key}: ${shortText}</span>`;
    }

  } catch (err) {
    console.error("[SUMMARY][ERR]", err);
  }
}
updateSummaryBar();
setInterval(updateSummaryBar, 30000);
</script>
