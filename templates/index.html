<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EURO_GOALS PRO+ v9.9.13</title>

  <link rel="manifest" href="/static/manifest.json" />
  <link rel="icon" href="/static/icons/eurogoals_192.png" sizes="192x192" />
  <meta name="theme-color" content="#0a84ff" />

  <style>
    :root {
      --bg: #0b1220;
      --fg: #e6eefc;
      --accent: #0a84ff;
      --ok: #2ecc71;
      --err: #ff6b6b;
      --panel: #121b30cc;
      --border: #2a3a5a;
    }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: ui-sans-serif, system-ui;
    }
    header {
      position: sticky;
      top: 0;
      background: #0d1526cc;
      backdrop-filter: blur(8px);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: .5rem 1rem;
      z-index: 10;
    }
    header h1 { font-size: 1.1rem; margin: 0; }
    .eg-btn {
      background: transparent;
      border: 1px solid var(--accent);
      border-radius: 8px;
      color: var(--accent);
      padding: .3rem .6rem;
      cursor: pointer;
      transition: .2s;
      margin-left: .4rem;
    }
    .eg-btn:hover { background: var(--accent); color: #fff; }
    .ghost { border: none; color: var(--fg); }
    main { padding: 1rem; }

    /* === SUMMARY BAR === */
    #system-summary {
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: .6rem 1rem;
      background: var(--panel);
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      box-shadow: 0 2px 5px #0004 inset;
      font-size: 0.9rem;
      position: sticky;
      top: 3rem;
      z-index: 9;
    }
    #system-summary div {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: .1rem;
    }
    #system-summary span.label { opacity: .7; font-size: .75rem; }
    #refresh-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent);
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%,100% { opacity: .6; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.3); }
    }

    /* Smart Console (Î¯Î´Î¹Î¿ ÏŒÏ€Ï‰Ï‚ Ï€ÏÎ¹Î½) */
    #eg-console {
      position: fixed; bottom: 1rem; right: 1rem;
      width: 320px; background: var(--panel);
      border: 1px solid var(--border); border-radius: 14px;
      box-shadow: 0 0 20px #0008; padding: .8rem 1rem; z-index: 50;
      backdrop-filter: blur(8px);
    }
    #eg-console.hidden { display: none; }
    #eg-console h3 { margin: 0 0 .5rem 0; }
    .console-row { display: flex; justify-content: space-between; margin: .3rem 0; }

    /* Toast alert */
    .toast {
      position: fixed; top: 1rem; right: 1rem;
      background: var(--err); color: #fff;
      padding: .7rem 1.1rem; border-radius: 8px;
      box-shadow: 0 0 10px #0006; font-weight: 600;
      z-index: 999; opacity: 0;
      transform: translateY(-15px);
      animation: blipIn .3s forwards, fadeOut 5s forwards;
    }
    @keyframes blipIn { to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeOut { 90% {opacity:1;} 100% {opacity:0;transform:translateY(-15px);} }
  </style>
</head>
<body>

  <header>
    <h1>âš½ EURO_GOALS PRO+ v9.9.13</h1>
    <div>
      <button id="themeToggle" class="eg-btn ghost">ğŸŒ“</button>
      <button id="btnConsole" class="eg-btn ghost">ğŸ§©</button>
    </div>
  </header>

  <!-- Unified Summary Panel -->
  <div id="system-summary">
    <div><b id="djStat">â³</b><span class="label">DowJones</span></div>
    <div><b id="smStat">â³</b><span class="label">SmartMoney</span></div>
    <div><b id="gmStat">â³</b><span class="label">GoalMatrix</span></div>
    <div><div id="refresh-dot"></div><span class="label" id="lastUpdate">-</span></div>
  </div>

  <main>
    <h2>Unified Dashboard</h2>
    <p>Î¤Î¿ EURO_GOALS PRO+ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ ÏƒÏ…Î½ÎµÏ‡ÏÏ‚ ÏŒÎ»Î± Ï„Î± modules Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… Unified System Status API.</p>
  </main>

  <!-- Smart Console -->
  <section id="eg-console" class="hidden">
    <h3>Smart Console</h3>
    <div class="console-row"><b>DowJones:</b> <span id="djStatus">â³</span></div>
    <div class="console-row"><b>SmartMoney:</b> <span id="smStatus">â³</span></div>
    <div class="console-row"><b>GoalMatrix:</b> <span id="gmStatus">â³</span></div>
    <div class="console-row"><b>History:</b> <span id="histStatus">â³</span></div>
    <hr />
    <div class="console-row"><b>SmartMoney Alerts:</b> <span id="smAlerts">0</span></div>
    <div class="console-row"><b>GoalMatrix Alerts:</b> <span id="gmAlerts">0</span></div>
  </section>

  <script>
    const themeBtn = document.getElementById("themeToggle");
    themeBtn.addEventListener("click", () => {
      const dark = document.body.classList.toggle("dark");
      document.documentElement.style.setProperty("--bg", dark ? "#e6eefc" : "#0b1220");
      document.documentElement.style.setProperty("--fg", dark ? "#0b1220" : "#e6eefc");
    });

    const btnConsole = document.getElementById("btnConsole");
    const consolePanel = document.getElementById("eg-console");
    btnConsole.addEventListener("click", () => consolePanel.classList.toggle("hidden"));

    function showToast(msg) {
      const t = document.createElement("div");
      t.className = "toast";
      t.textContent = msg;
      document.body.appendChild(t);
      setTimeout(() => t.remove(), 5500);
    }

    let failCount = 0;

    async function updateSystem() {
      try {
        const res = await fetch("/api/system/status");
        const data = await res.json();

        const djOK = !data.engines.dowjones.includes("error");
        const smOK = !data.engines.smartmoney.includes("error");
        const gmOK = !data.engines.goalmatrix.includes("error");

        // summary bar
        document.getElementById("djStat").textContent = djOK ? "ğŸ§ " : "âŒ";
        document.getElementById("smStat").textContent = smOK ? "ğŸ’°" : "âŒ";
        document.getElementById("gmStat").textContent = gmOK ? "ğŸ¯" : "âŒ";
        document.getElementById("lastUpdate").textContent = new Date(data.timestamp).toLocaleTimeString();

        // console
        document.getElementById("djStatus").textContent = djOK ? "ğŸŸ¢ OK" : "ğŸ”´ Error";
        document.getElementById("smStatus").textContent = smOK ? "ğŸŸ¢ OK" : "ğŸ”´ Error";
        document.getElementById("gmStatus").textContent = gmOK ? "ğŸŸ¢ OK" : "ğŸ”´ Error";
        document.getElementById("histStatus").textContent = data.engines.history.includes("error") ? "ğŸ”´ Error" : "ğŸŸ¢ OK";
        document.getElementById("smAlerts").textContent = data.alerts.smartmoney || 0;
        document.getElementById("gmAlerts").textContent = data.alerts.goalmatrix || 0;

        failCount = 0;
      } catch {
        failCount++;
        if (failCount === 3) showToast("âš ï¸ Unified API Unavailable");
      }
    }

    setInterval(updateSystem, 10000);
    updateSystem();
  </script>
</body>
</html>
