<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EURO_GOALS PRO+ v9.7.2</title>
  <link rel="manifest" href="/static/manifest.json" />
  <link rel="icon" href="/static/icons/eurogoals_192.png" />
  <link rel="apple-touch-icon" href="/static/icons/eurogoals_512.png" />
  <meta name="theme-color" content="#0a84ff" />
  <link rel="stylesheet" href="/static/css/unified_theme.css" />
</head>

<body>
  <header class="eg-header">
    <div class="title">EURO_GOALS PRO+ <span class="ver">v9.7.2</span></div>
    <div class="actions">
      <button id="btnToggleOverlay" class="ghost">Overlay</button>
      <button id="btnRefresh" class="ghost" onclick="location.reload()">Refresh</button>
    </div>
  </header>

  <main class="eg-main">
    <section class="placeholder">
      <h2>Matchplan / Standings</h2>
      <p>Δείγμα σελίδας για έλεγχο overlay.</p>
      <div class="sample-matches">
        <button class="m-btn" data-mid="EPL_2025_ARS_BHA">ARS vs BHA</button>
        <button class="m-btn" data-mid="GRE_2025_PAO_AEK">PAO vs AEK</button>
      </div>
    </section>
  </main>

  <!-- Overlay UI -->
  <div id="eg-overlay" class="eg-overlay hidden" style="opacity:0.94">
    <div class="overlay-header">
      <div>GoalMatrix + SmartMoney</div>
      <div class="mini-actions">
        <button id="ovCompact" title="Compact">◐</button>
        <button id="ovClose" title="Close">✕</button>
      </div>
    </div>
    <div id="ovContent" class="overlay-content">
      <div class="ov-col">
        <h4>GoalMatrix</h4>
        <canvas id="ovHeatmap" width="220" height="220"></canvas>
        <div id="ovInsights" class="kv"></div>
      </div>
      <div class="ov-col">
        <h4>SmartMoney</h4>
        <div id="ovOdds" class="table"></div>
        <div id="ovSignals" class="list"></div>
      </div>
    </div>
  </div>

  <script src="/static/js/overlay.js"></script>
  <script>
    document.querySelectorAll('.m-btn').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const mid = btn.dataset.mid;
        const payload = await fetch(`/overlay/match/${encodeURIComponent(mid)}`).then(r=>r.json());
        window.egOverlay?.showWithPayload(payload);
      });
    });

    // ✅ Σταθερό service-worker.js με auto version update
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/static/service-worker.js')
        .then(() => console.log('[SW] Registered'))
        .catch(() => console.warn('[SW] Failed to register'));
    }
  </script>
</body>
</html>
