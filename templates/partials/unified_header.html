<header class="eg-header">

    <nav class="eg-nav">
        <a href="#dowjones" class="eg-nav-btn">ğŸ§­ DowJones</a>
        <a href="#smartmoney" class="eg-nav-btn">ğŸ’° SmartMoney</a>
        <a href="#goalmatrix" class="eg-nav-btn">ğŸ¯ GoalMatrix</a>

        <button id="open-controls"   class="eg-nav-btn">âš™ï¸</button>
        <button id="theme-toggle"    class="eg-nav-btn">ğŸŒ“</button>
        <button id="force-refresh"   class="eg-nav-btn">ğŸ”</button>

        <!-- INSTALL PWA BUTTON -->
        <button id="eg-install-btn" class="eg-nav-btn" style="display:none;">
            ğŸ“² Install App
        </button>
    </nav>

</header>

<!-- =============================== -->
<!-- PWA INSTALL LOGIC -->
<!-- =============================== -->

<script>
let deferredPrompt = null;

// Capture install event before browser shows default banner
window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault();
    deferredPrompt = e;

    console.log("[PWA] Install prompt captured.");

    const btn = document.getElementById("eg-install-btn");
    if (btn) btn.style.display = "inline-block";
});

// When user clicks Install App
document.getElementById("eg-install-btn")?.addEventListener("click", async () => {

    if (!deferredPrompt) {
        console.warn("[PWA] No install prompt available.");
        return;
    }

    deferredPrompt.prompt();

    await deferredPrompt.userChoice;
    deferredPrompt = null;

    // Hide button after install attempt
    const btn = document.getElementById("eg-install-btn");
    if (btn) btn.style.display = "none";
});
</script>

<style>
.eg-nav-btn {
    padding: 4px 10px;
    border-radius: 6px;
    background: #1a273d;
    color: var(--fg);
    border: 1px solid #33425a;
    cursor: pointer;
    font-size: 14px;
}

/* Ensure install button is hidden by default */
#eg-install-btn {
    display: none;
}
</style>
