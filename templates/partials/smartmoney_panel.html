<!-- ============================================================
     EURO_GOALS PRO+ v9.5.5 â€“ SmartMoney Panel (Unified Expansion)
     Î•Î½Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ dashboard Î³Î¹Î± SmartMoney Engine
============================================================ -->
<section class="card smartmoney-panel bg-neutral-900/70 text-gray-100 rounded-xl shadow p-3 backdrop-blur-md transition-all">
  <header class="flex justify-between items-center mb-2">
    <h3 class="text-lg font-semibold text-emerald-400">ğŸ’° SmartMoney Engine</h3>
    <span id="sm-status-pill" class="px-2 py-1 rounded text-xs bg-gray-600 text-white">Loading...</span>
  </header>

  <div class="flex flex-wrap justify-between text-sm mb-2 text-gray-300">
    <span id="sm-summary-total">Alerts: 0</span>
    <span id="sm-summary-active">Active: 0</span>
    <span id="sm-summary-time">Last update: --:--:--</span>
    <button id="sm-refresh" class="text-xs px-2 py-1 bg-emerald-700 text-white rounded hover:bg-emerald-600 transition">
      ğŸ”„ Refresh
    </button>
  </div>

  <div class="table-container overflow-x-auto max-h-[420px]">
    <table class="w-full text-sm border-collapse">
      <thead class="bg-gray-800 text-emerald-400 sticky top-0 z-10">
        <tr>
          <th class="p-2 text-left">League</th>
          <th class="p-2 text-left">Match</th>
          <th class="p-2 text-left">Bookmaker</th>
          <th class="p-2 text-right">Movement</th>
          <th class="p-2 text-right">Signal</th>
          <th class="p-2 text-center">Status</th>
        </tr>
      </thead>
      <tbody id="sm-body" class="divide-y divide-gray-700 text-gray-200">
        <tr>
          <td colspan="6" class="p-2 text-center text-gray-400">Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ SmartMoney...</td>
        </tr>
      </tbody>
    </table>
  </div>

  <footer class="text-xs text-gray-500 mt-2">
    * Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÎºÎ¬Î¸Îµ 30 s â€“ SmartMoney Unified API Feed
  </footer>
</section>

<script>
  // ============================================================
  // SMARTMONEY PANEL SCRIPT â€“ EURO_GOALS v9.5.5 PRO+ Unified Expansion
  // ============================================================
  async function loadSmartMoneyData() {
    const body = document.getElementById("sm-body");
    const pill = document.getElementById("sm-status-pill");

    try {
      const [summaryRes, alertsRes] = await Promise.all([
        fetch("/api/smartmoney/summary"),
        fetch("/api/smartmoney/alerts")
      ]);

      const summary = await summaryRes.json();
      const alertsData = await alertsRes.json();
      const alerts = alertsData?.alerts || [];

      pill.textContent = "ON";
      pill.className = "px-2 py-1 rounded text-xs bg-green-500 text-black font-semibold";

      if (alerts.length === 0) {
        body.innerHTML = `<tr><td colspan="6" class="p-2 text-center text-gray-400">No active SmartMoney alerts.</td></tr>`;
      } else {
        body.innerHTML = alerts
          .map(a => `
            <tr class="hover:bg-neutral-800/60 transition">
              <td class="p-2">${a.league || "-"}</td>
              <td class="p-2">${a.match || "-"}</td>
              <td class="p-2">${a.bookmaker || "-"}</td>
              <td class="p-2 text-right">${a.movement || "-"}</td>
              <td class="p-2 text-right ${
                a.signal === "Strong"
                  ? "text-green-400"
                  : a.signal === "Weak"
                  ? "text-yellow-300"
                  : "text-gray-300"
              }">${a.signal || "â€“"}</td>
              <td class="p-2 text-center ${
                a.active ? "text-green-400" : "text-red-400"
              }">${a.active ? "Active" : "Closed"}</td>
            </tr>
          `)
          .join("");
      }

      // summary info
      document.getElementById("sm-summary-total").textContent = `Alerts: ${alerts.length}`;
      const activeCount = alerts.filter(a => a.active).length;
      document.getElementById("sm-summary-active").textContent = `Active: ${activeCount}`;
      document.getElementById("sm-summary-time").textContent =
        "Last update: " + new Date().toLocaleTimeString("el-GR", { hour12: false });
    } catch (err) {
      console.warn("[EURO_GOALS] SmartMoney fetch error:", err);
      pill.textContent = "OFF";
      pill.className = "px-2 py-1 rounded text-xs bg-red-600 text-white";
      body.innerHTML = `<tr><td colspan="6" class="p-2 text-center text-gray-400">âš  Î£Ï†Î¬Î»Î¼Î± Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.</td></tr>`;
    }
  }

  document.getElementById("sm-refresh")?.addEventListener("click", loadSmartMoneyData);
  window.addEventListener("load", loadSmartMoneyData);
  setInterval(loadSmartMoneyData, 30000);
</script>
